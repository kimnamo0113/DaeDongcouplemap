<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ko.mapper.GuestMapper">
	
	<select id="selectById" resultType="Guest" parameterType="Guest">
		select * from guest where g_id = #{gId}
	</select>
	<select id="selectByEmail" resultType="Guest" parameterType="string">
		select * from guest where g_email=#{gEmail}
	</select>
	
	<!-- 회원가입시 중복체크용 -->
		<select id="selectIdCheck" resultType="int">
			select count(g_no) from guest where g_id = #{gId}
		</select>
		<select id="selectEmailCheck" resultType="int">
			select count(g_no) from guest where g_email = #{gEmail}
		</select>
	<!--  -->
	
	<!-- 회원가입후-->
		<insert id="insertJoinDefault" parameterType="Guest" useGeneratedKeys="true" keyProperty="gNo">
			INSERT INTO guest
			(g_id, g_password, g_name, g_email, g_join, g_certification)
			VALUES(#{gId}, password(#{gPassword}), #{gName}, #{gEmail}, now(), #{gCertification});
		</insert>	
		<update id="updateJoinPlus" parameterType="Guest">
			UPDATE guest
			set g_tel=#{gTel}, g_birth=#{gBirth}, g_join=#{gJoin}, g_memo=#{gMemo}, g_addr=#{gAddr}, g_addr2=#{gAddr2}, g_addr3=#{gAddr3}, g_image=#{gImage}, g_certification=#{gCertification}
			WHERE g_no=#{gNo};
		</update>
		<!-- 인증 -->
		<update id="updateCertification" parameterType="Guest">
			update guest
			SET g_tel=#{gTel}, g_birth=#{gBirth}, g_addr=#{gAddr}, g_addr2=#{gAddr2}, g_addr3=#{gAddr3}, g_gender=#{gGender} 
			where g_email = #{guest.gEmail} and g_certification = #{guest.gCertification}
		</update>

	<!--  -->
	
	<!-- 비밀번호 변경 -->	
		<update id="updatePassWord" parameterType="Guest">
			UPDATE guest
			SET g_password=password(#{gPassword})
			WHERE g_no=#{gNo};
		</update>
	
	<!-- 로그인시 체크 -->
		<select id="selectByEmailAndPassword" resultType="Guest">
			select * from guest where g_email=#{gEmail} and g_password=password(#{gPassword})
		</select>
	<!--  -->
	
</mapper>