<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ko.mapper.BoardMapper">
	<insert id="insertBoard" parameterType="Board" useGeneratedKeys="true" keyProperty="bNo">
		INSERT INTO daedong.board
		(g_no, b_place, b_title, b_hash, b_contents, b_writetime, b_delete, b_flat, b_good)
		VALUES(#{gNo}, #{bPlace}, #{bTitle},#{bHash},#{bContents}, now(), 0, 0, 0);
		
	</insert>
	<resultMap type="Board" id="BoardBasic">
		<result property="bNo" column="b_no" />
		<result property="gNo" column="g_no" />
		<result property="mNo" column="m_no" />
		<result property="bPlace" column="b_place" />
		<result property="bTitle" column="b_title" />
		<result property="bHash" column="b_hash" />
		<result property="bContents" column="b_contents" />
		<result property="bWritetime" column="b_writetime" />
		<result property="bDelete" column="b_delete" />
		<result property="bFlat" column="b_flat" />
		<result property="bGood" column="b_good" />
	</resultMap>
	
	<resultMap type="Board" id="BoardDetail" extends="BoardBasic">
		<collection property="contents" resultMap="com.ko.mapper.ContentMapper.contentBasic"/>
		<collection property="replys" resultMap="com.ko.mapper.ReplyMapper.ReplyBasic"/>
	</resultMap>
	
	
	<select id="selectAll" resultType="Board" resultMap="BoardDetail">
		select b.b_no, g_no, m_no, b_title, b_place, b_hash, b_contents, b_writetime, b_delete, b_flat, b_good, c_no, c_contents, c_image
		from board b
		left join content c
		on c.b_no = b.b_no
	</select>
	<!-- <select id="selectLimit10" resultType="Board" resultMap="BoardDetail">
		select b.b_no, g_no, m_no, b_title, b_place, b_hash, b_contents, b_writetime, b_delete, b_flat, b_good, c_no, c_contents, c_image
		from (select * from board order by b_no desc limit #{i},10) as b left join content c on c.b_no = b.b_no;
	</select> -->
	<select id="selectLimit10" resultType="Board" resultMap="BoardDetail">
		select b.b_no, b.g_no, b.m_no, b_title, b_place, b_hash, b_contents, b_writetime, b_delete, b_flat, b_good,
			c.c_no, c.c_contents, c.c_image
		from (select * from board order by b_no desc limit #{i},10) as b 
		left join content c
			on c.b_no = b.b_no
		order by b.b_no desc;
	</select>
</mapper>